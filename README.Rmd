---
title: "shit happens index"
output: github_document
bibliography: src/references.bib
csl: src/elsevier-harvard.csl
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,
                      fig.path = "results/")

library(tidyverse)
library(lme4)
library(broom.mixed)
library(flextable)
```

Estimating coefficients for measuring psychological distress resulting from various life events  

<br>

## Extension and validation of stressful life events schedule

Instruments for measuring the severity of psychological distress resulting from recent life experiences were originally developed in the 1960s, and are used by clinicians today to identify and predict sources of patient stress. The instrument consists of a checklist containing a list of major life events (e.g., divorce, bankruptcy, death of a loved one), and a weighting is assigned to each item that was determined by asking research volunteers to anticipate the severity of stress that was expected from its occurrence. However people are notoriously poor at anticipating their emotional reaction to abstract events, and large population-based surveys can now provide data which tracks self-reported distress levels after survey respondants have experienced the life event. This provides an opportunity to calculate weights based on experienced distress levels rather than anticipated distress, and so can provide a way to base clinical predictions on empirical evidence. Our other work (`shit-happens`) has determined the causal effect of major life events on clinically-relevant distress measures in large population-based survey data, and results from this project will update current clinical instruments to improve care in Australia.  

#### Background  

Stressful life events have been identified as a risk factor for a variety of physical and mental illnesses such as cardiovascular disease, cancer, metabolic syndrome, and depression [@bahri2019relation; @kessler1997effects; @slopen2011sex]. Today, clinicians and epidemiologists often assesses the impact of life-events through summed checklists that treat events as equal  [@dohrenwend2006inventorying; @gray2004psychometric; @wethington1995interview]. For example, the Life Events Checklist (LEC) [@gray2004psychometric] is a checklist of events which are associated with the aetiology of PTSD; responders must indicate the degree of exposure (e.g., directly experienced vs witnessed vs heard about), but the LEC does not distinguish the amount of distress from the event itself. A key feature of such checklists is that all life events are treated as equivalent, along with the implicit assumption that different life events have equivalent impacts on distress.  

The original instrument to measure life events was Holmes and Raheâ€™s Social Readjustment Rating Scale (SRRS) [@holmes1967social], and this included weights to distinguish and quantify the amount of stress associated with each event. The publication of the SRRS led to an enormous amount of research on the relationship between life events and various types of illness onset (typically screening scales of nonspecific psychological distress), with over 1000 papers using the SRRS published in the first decade after its development [@holmes1979; @kessler1997effects]. It's reputed advance was in adapting the psychophysical procedure of magnitude estimation to quantify the stressfulness of an event [@dohrenwend1974stressful], which was entirely based on the amount of stress anticipated by research volunteers when imagining the event. Subsequent methodological critiques pointed out the limitations of this method [@dohrenwend1974stressful; @zimmerman1983methodological]; and within the set of fairly serious events included in SRRS life event checklists, the use of differential weights does not markedly increase the association between life event scales and measures of distress [@tibubos2021frequency; @zimmerman1983methodological]. Thus it is not clear whether and how operationalization of a differential weight improves the predictive value of life events checklists over and above frequency or the sum of exposure, and this widely appreciated limitation has led to the proliferation of summed checklists (Turner & Wheaton 1995).  

> In addition, methodological studies of the SRRS (and the various checklists based on it) also demonstrated that negative events are much more powerful predictors of mental health outcomes than positive events [@zautra1983life], and that distinctions along a number of other dimensions (e.g. amount of loss, amount of threat, degree of controllability of consequences of the event) do lead to substantial increases in the association between negative life event scales and measures of distress (Thoits 1983). 


<br><br>



##### To do list   

- Add estimated prevalence of each event
- Estimate weights controlling for age (decade), gender, other events
- Estimate predictive value of events for subsequent MHi5 < 54?


<br><br>


## Methods  

```{r import-preprocess.R}
mhi5 <- read_rds("data/mhi5_by_all_lifeevents.rds")

# This includes all events, but we may want to select events with MHi5 observations
# before and after the event (i.e., balanced)
```

```{r fit-unconditional, eval=F}
unconditional_fit <- function(.df) {
  
  # this is the simplest model: zMHi5 ~ event_dummy + mMHi5 + (1|person) + (1|wave)
  # It includes effects for wave and person, but not age, sex, other events etc.
  # Variation in mean levels of MHi5 and the event itself are partitioned separately
  
  require(lme4)
  
  .df %>%
    group_by(xwaveid) %>%
    mutate(y = c(scale(ghmh))) %>%
    ungroup() %>%
    mutate(
      time = fct_relevel(time, "pre36", "pre24", "pre12"),
      y = replace_na(y, 0)
    ) -> df
  
  ghmh_m <- select(df, xwaveid, year, ghmh) %>%
    distinct() %>%
    group_by(xwaveid) %>%
    summarise(m = mean(ghmh)) %>%
    mutate(sm = c(scale(m)))
  
  df <- left_join(df, ghmh_m)
  
  lmer(y ~ 0 + time + m + (1|xwaveid) + (1|wave), data = df)
  
}

fits <- map(mhi5, 
            .f = ~unconditional_fit(.))

write_rds(fits, "results/lmm_fits.rds")
```

## Results  

Standardized beta coefficients representing the amount of change in MHi-5 scores around each life event are shown below.  


##### Figure 1. Time-varying effects of different life events  
```{r load-fits}
fits <- read_rds("results/lmm_fits.rds")
```

```{r plot_fits, echo=F, fig.dim = c(9, 9)}
map(fits, ~fixef(.) %>% 
      as_tibble(rownames = "coef")
    ) %>%
  bind_rows(.id = "event") %>%
  filter(coef != "m") %>%
  mutate(time = str_remove(coef, "time"),
         time = fct_relevel(time, "pre36", "pre24", "pre12")) %>% 
  group_by(event) %>%
  mutate(worst = min(value),
         `pre` = value[time == "pre12"],
         `3mo` = value[time == "post03"],
         `12mo` = value[time == "post12"]) %>% 
  ungroup() %>%
  mutate(event = fct_reorder(event, `3mo`)) %>%
  ggplot(aes(x = time, y = value)) +
    geom_line(group = 1) +
    facet_wrap(~event) +
    guides(x =  guide_axis(angle = 33)) +
    labs(subtitle = "Ordered by 3 mo effect", x = "") +
    theme_minimal()
```
<br><br>

The beta coefficients from these models were used to assign weightings to each event at different time points: 12 mo prior to the event, 3 mo post event, and 12 mo post event.  

#### Table 1. Time-varying weights for life events  

```{r table_1, echo=F, eval=F}
map(fits, ~tidy(., effects = "fixed", conf.int = T)) %>%
  bind_rows(.id = "event") %>%
  filter(term %in% c("timepre12", "timepost03", "timepost12")) %>%
  transmute(
    event,
    term = str_remove(term, "time"),
    estimate = if_else(0 > conf.low & 0 < conf.high, 
                       as.character(round(-1*estimate, 2)), 
                       paste0(round(-1*estimate, 2), "*"))
  ) %>%
  spread(term, estimate) %>%
  mutate(val = parse_number(post03),
         event = fct_reorder(event, val)) %>%
  arrange(desc(event)) %>%
  select(`Life event` = event, pre12, post03, post12) %>%
  flextable() %>%
  footnote(
    i = 1, j = 1,
    ref_symbols = "",
    value = as_paragraph("*p < .05")
  ) %>%
  autofit() %>%
  save_as_image(path = "results/weight_table_1.png")
```

<img src="results/weight_table_1.png" alt="Table 1" style="height: 800px;"/>

<br>

The impact of events on mental health (MHi-5 scores) varies by event and by time. Consequently, the weighting of each event varies. For example, death of spouse (`Widowed`) and divorce or separation (`Divorced`) are the two worst events at 3 mo afterwards, however by 12 mo afterwards `Bankruptcy` is the worst event, with `Widowed` equal second (along with serious injury `Injured`) and `Divorced` is equal eighth and not significantly different from zero (*p* > .05).  

Some events have a positive effect on mental health (MHi-5 scores) and so are given a negative weighting in this scheme. Marriage, childbirth and pregnancy all have negative weights up to 12 months before the event and three months afterwards. At 12 months after these events, the weight is not significantly different from zero (*p* > .05), highlighting the temporary emotional impact of these positive life events (nb. changes to life satisfaction scores have longer impacts after these events, but not considered here).  



<br><br>

## Discussion  

The use of generic weights rather than subjective weights is promoted on the grounds that generic weights are _a priori_ independent from the experience of the event, and so can predict consequences of the stress exposure such as the risk of poor health. Interestingly the rank-ordering of life events assigned by diverse subgroups are often highly correlated (*&rho;* > 0.9), suggesting a shared or generalizable experience of stress, which also supports the use of generic weights. Others have argued the generalizability of any life event scale will be limited to the population on which the weights were developed [@@dohrenwend1974stressful; @zimmerman1983methodological]. The HILDA sample on which our weights were developed was selected so as to be representative of Australia, but we expect the weights would be equally applicable to other developed Western nations.   

<br>

##### Limitations  

Events are broad and vaguely defined, and so may capture heterogeneity in the response (e.g., divorce, vs divorce after a period of marital conflict and infidelity) [@dohrenwend2006inventorying]  

<br>

##### Strengths  

Problems in defining and sampling the relevant population for stressful life events are often present in life events research [see @dohrenwend1974stressful], but are minimised here by probabilistic sampling of the Australian population in HILDA. Furthermore, the relationship between a stressful life event and a health outcome can be interpreted as causal when exposure to the event occurred for reasons that are random with respect to the outcome [@kessler1997effects], which is the case here under HILDA's probabilistic sampling method. However selection bias may still exist if some victims are less likely to report an event than others (e.g., homelessness, sexual assault, or severely affected sufferers).

<br><br>


## References  



